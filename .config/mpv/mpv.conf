###General
profile=gpu-hq
vo=gpu-next
gpu-api=vulkan
vulkan-async-compute=yes
vulkan-async-transfer=yes
vulkan-queue-count=1
vulkan-swap-mode=fifo # fifo - vsync, avoids tearing; mailbox - triple buffer, low latency (if supported)
vd-lavc-dr=yes # direct rendering, less CPU
vd-lavc-threads=auto
# vd-lavc-fast=yes # faster but less accurate
hwdec=auto
# priority=high # Makes PC prioritize MPV for allocating resources.
cursor-autohide-fs-only
reset-on-next-file=pause # Resumes playback when skip to next file
volume=80 # Set volume to 100% on startup.
volume-max=200 # Set player max vol to 200%.
# border=no # uosc will draw its own window controls if you disable window border
#no-hidpi-window-scale # This Disables High DPI scaling
audio-pitch-correction=yes # automatically insert scaletempo when playing with higher speed
#fs=yes # start in fullscreen?
#snap-window # yes, no, border, screen
write-filename-in-watch-later-config
#audio-exclusive=yes # Allow only mpv to send direct audio signals to the soundbar
#audio-channels=stereo,5.1,7.1 # Allow more than just one audio channel

###HDR to SDR
tone-mapping=bt.2390 # good HDR to SDR mapping apparently
hdr-compute-peak=yes # better HDR tone-mapping accuracy
dither-depth=auto # applies dithering to avoid banding when reducing bit-depth

###Interpolation (May increase CPU usage)
interpolation=yes
#video-sync=display-resample
tscale=box # may switch to linear
tscale-window=quadric
tscale-clamp=0.0 # clamps scaling to avoid extreme ringing, 0 should be fine
tscale-radius=1.025 # radius of scaling filter

###Subtitles
alang = 'jpn,jp,ja,eng,en'
slang = 'eng,en,enUS,enm,en-GB,en-US,bn,ben' # enUS for Crunchyroll and enm for honorifics
subs-with-matching-audio=no # Won't ignore subtitles tagged as "Forced"
sub-fix-timing=yes
sub-scale=1
sub-auto=fuzzy
sub-gray=yes # Monochrome subs makes yellow font grey
sub-font='Trebuchet MS'
sub-bold=yes # Set the font to bold.
sub-file-paths=** # This is for fuzzy-dir script to work
#sub-font-size=55 # Set default subtitle size if not specified.

###Youtube-dl settings
ytdl-format=bestvideo[height<=?1080]+bestaudio/best # Set max streaming quality as 1080p.

#Default demuxer is 150/75 MB, note that this uses RAM so set a reasonable amount.
demuxer-mkv-subtitle-preroll=yes
demuxer-max-bytes=150000000 # 150MB, Max pre-load for network streams (1 MiB = 1048576 Bytes).
demuxer-max-back-bytes=75000000 # 75MB, Max loaded video kept after playback.
stream-buffer-size=8MiB

###OSC / OSD
#osc=no # required so that the 2 UIs don't fight each other
#osd-bar=no # uosc provides its own seeking/volume indicators, so you also don't need this
#osd-font="Inter Regular"
#osd-font-size=30

###Profiles


[Web]
	profile-cond=string.match(p.filename, "HorribleSubs")~=nil or string.match(p.filename, "Erai%-raws")~=nil or string.match(p.filename, "SubsPlease")~=nil
	profile-restore=copy-equal
	deband=yes

[Mini-Encode #1]
	profile-cond=string.match(p.filename, "ASW")~=nil or string.match(p.filename, "DKB")~=nil or string.match(p.filename, "Judas")~=nil
	profile-restore=copy-equal
	deband=yes

[Mini-Encode #2]
	profile-cond=string.match(p.filename, "Cerberus")~=nil or string.match(p.filename, "Nep%_Blanc")~=nil or string.match(p.filename, "Reaktor")~=nil
	profile-restore=copy-equal
	deband=yes

[Mini-Encode #3]
	profile-cond=string.match(p.filename, "Cleo")~=nil or string.match(p.filename, "Akihito")~=nil or string.match(p.filename, "Reaktor")~=nil
	profile-restore=copy-equal
	deband=yes

[Mini-Encode #4]
	profile-cond=string.match(p.filename, "Ember")~=nil
	profile-restore=copy-equal
	deband=yes

[Twitch]
	profile-cond=get("path", ""):find("^https://www.twitch.tv/") ~= nil
	profile-restore=copy-equal
	sub-font-size=30
	sub-align-x=right
	sub-align-y=top
	sub-scale=0.5

[Youtube]
	profile-cond=get("path", ""):find("^https://www.youtube.com/") ~= nil or get("path", ""):find("^https://youtu.be/") ~= nil
	profile-restore=copy-equal
	ytdl-raw-options=sub-langs=[en.*,ben.*],write-sub=,write-auto-sub=,ignore-config=,embed-metadata=,yes-playlist=
	sub-font=Liberation Sans Narrow
	sub-scale=0.5
	sub-bold=yes
	sub-shadow-color="#ff000000"
	sub-shadow-offset=2.5
	sub-back-color="#aa000000"
	sub-border-color="#ff0a0a0a"
	sub-border-size=0.75

[Anime]
	profile-cond=require 'mp.utils'.join_path(working_directory, path):match('Anime') ~= nil
	profile-restore=copy-equal
	deband=yes #Default values are 1:64:16:48
	deband-iterations=2 # Range 1-16.
	deband-threshold=35 # Range 0-4096.
	deband-range=20 # Range 1-64.
	deband-grain=5 # Range 0-4096.
	glsl-shaders-clr
	glsl-shaders="~~/shaders/Anime4K_Clamp_Highlights.glsl;~~/shaders/Anime4K_Restore_CNN_VL.glsl;~~/shaders/Anime4K_Upscale_CNN_x2_VL.glsl;~~/shaders/Anime4K_Restore_CNN_M.glsl;~~/shaders/Anime4K_AutoDownscalePre_x2.glsl;~~/shaders/Anime4K_AutoDownscalePre_x4.glsl;~~/shaders/Anime4K_Upscale_CNN_x2_M.glsl"

[NotAnime]
	profile-cond=(working_directory .. path):match('Anime') == nil
	profile-restore=copy-equal
	fbo-format=rgba16hf
	glsl-shaders-clr
	glsl-shaders="~~/shaders/SSimDownscaler.glsl;~~/shaders/FSRCNNX_x2_8-0-4-1.glsl;~~/shaders/KrigBilateral.glsl"
	scale=ewa_lanczos
	dscale=mitchell
	linear-downscaling=no
	cscale=mitchell # ignored with gpu-next
	sigmoid-upscaling=yes

[Audio]
	profile-cond=string.match(p.filename, "%.mp3$")~=nil or string.match(p.filename, "%.ogg$")~=nil or string.match(p.filename, "%.wav$")~=nil or string.match(p.filename, "%.flac$")~=nil or string.match(p.filename, "%.aac$")~=nil or string.match(p.filename, "%.wma$")~=nil or string.match(p.filename, "%.m4a$")~=nil or string.match(p.filename, "%.opus$")~=nil or string.match(p.filename, "%.vorbis$")~=nil or string.match(p.filename, "%.alac$")~=nil#  ("%.flac$" and "%.mp3$" are lua string patterns that match strings only if they ends in ".flac" or ".mp3" respectively).
	fs=no
	geometry=20%+100%+0% # the syntax here is: <size of the window>+<x value of the position>+<y value of the position>

[Video]
	profile-cond=get("current-tracks/video/albumart") == false
	profile-restore=copy-equal
	save-position-on-quit
	watch-later-options-add=video-zoom

[autoloop]
	profile-cond=duration <= 60
	profile-restore=copy-equal
	loop-file=inf

[protocol.http]
	hls-bitrate=max # use max quality for HLS streams
	force-seekable=yes # Force stream to be seekable even if disabled.
	cache=yes
	no-cache-pause # don't pause when the cache runs low

[protocol.https]
	profile=protocol.http

[protocol.ytdl]
	profile=protocol.http

[Dolby Vision]
	target-trc=pq
	target-prim=bt.2020

[Snapcast]
	#audio-display=no
	audio-channels=stereo
	audio-samplerate=48000
	audio-format=s16
	ao=pcm
	ao-pcm-file=/tmp/snapfifo
#
# Example mpv configuration file
#
# Warning:
#
# The commented example options usually do _not_ set the default values. Call
# mpv with --list-options to see the default values for most options. There is
# no builtin or example mpv.conf with all the defaults.
#
#
# Configuration files are read system-wide from /etc/mpv or /usr/local/etc/mpv,
# and per-user from ~/.config/mpv, where per-user settings override
# system-wide settings, all of which are overridden by the command line.
#
# Configuration file settings and the command line options use the same
# underlying mechanisms. Most options can be put into the configuration file
# by dropping the preceding '--'. See the man page for a complete list of
# options.
#
# Lines starting with '#' are comments and are ignored.
#
# See the CONFIGURATION FILES section in the man page
# for a detailed description of the syntax.
#
# Profiles should be placed at the bottom of the configuration file to ensure
# that settings wanted as defaults are not restricted to specific profiles.

##################
# video settings #
##################

# Start in fullscreen mode by default.
#fs=yes

# force starting with centered window
#geometry=50%:50%

# don't allow a new window to have a size larger than 90% of the screen size
#autofit-larger=90%x90%

# Do not close the window on exit.
#keep-open=yes

# Do not wait with showing the video window until it has loaded. (This will
# resize the window once video is loaded. Also always shows a window with
# audio.)
#force-window=immediate

# Disable the On Screen Controller (OSC).
#osc=no

# Keep the player window on top of all other windows.
#ontop=yes

# Specify fast video rendering preset (for --vo=<gpu|gpu-next> only)
# Recommended for mobile devices or older hardware with limited processing power
#profile=fast

# Specify high quality video rendering preset (for --vo=<gpu|gpu-next> only)
# Offers superior image fidelity and visual quality for an enhanced viewing
# experience on capable hardware
#profile=high-quality

# Force video to lock on the display's refresh rate, and change video and audio
# speed to some degree to ensure synchronous playback - can cause problems
# with some drivers and desktop environments.
#video-sync=display-resample

# Enable hardware decoding if available. Often, this does not work with all
# video outputs, but should work well with default settings on most systems.
# If performance or energy usage is an issue, forcing the vdpau or vaapi VOs
# may or may not help.
#hwdec=auto

##################
# audio settings #
##################

# Specify default audio device. You can list devices with: --audio-device=help
# The option takes the device string (the stuff between the '...').
#audio-device=alsa/default

# Do not filter audio to keep pitch when changing playback speed.
#audio-pitch-correction=no

# Output 5.1 audio natively, and upmix/downmix audio with a different format.
#audio-channels=5.1
# Disable any automatic remix, _if_ the audio output accepts the audio format.
# of the currently played file. See caveats mentioned in the manpage.
# (The default is "auto-safe", see manpage.)
#audio-channels=auto

##################
# other settings #
##################

# Pretend to be a web browser. Might fix playback with some streaming sites,
# but also will break with shoutcast streams.
#user-agent="Mozilla/5.0"

# cache settings
#
# Use a large seekable RAM cache even for local input.
#cache=yes
#
# Use extra large RAM cache (needs cache=yes to make it useful).
#demuxer-max-bytes=500M
#demuxer-max-back-bytes=100M
#
# Disable the behavior that the player will pause if the cache goes below a
# certain fill size.
#cache-pause=no
#
# Store cache payload on the hard disk instead of in RAM. (This may negatively
# impact performance unless used for slow input such as network.)
#cache-dir=~/.cache/
#cache-on-disk=yes

# Display English subtitles if available.
#slang=en

# Play Finnish audio if available, fall back to English otherwise.
#alang=fi,en

# Change subtitle encoding. For Arabic subtitles use 'cp1256'.
# If the file seems to be valid UTF-8, prefer UTF-8.
# (You can add '+' in front of the codepage to force it.)
#sub-codepage=cp1256

# You can also include other configuration files.
#include=/path/to/the/file/you/want/to/include

############
# Profiles #
############

# The options declared as part of profiles override global default settings,
# but only take effect when the profile is active.

# The following profile can be enabled on the command line with: --profile=eye-cancer

#[eye-cancer]
#sharpen=5
